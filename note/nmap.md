# Tcp SYN Scan (sS)

```
一个基本的扫描方式,它被称为半开放扫描,因为这种技术使得 nmap 不需要通过完整的握手,就能获得远程主机的信息.
nmap发送 SYN 包到远程主机,但是它不会产生任何会话.因此不会在目标主机上产生任何日志记录,因为没有形成会话.这个就是SYN扫描的优势.

如果 nmap 命令中没有指出扫描类型,默认的就是Tcp SYN.但是它需要 root/administrator 权限.
# nmap -sS 192.168.1.11
```

# Tcp connect() scan(sT)

```
如果不选择 SYN 扫描, TCP connect() 扫描就是默认的扫描模式.
不同于Tcp SYN 扫描,Tcp connect()扫描需要完成三次握手,并且要求调用系统的connect().
Tcp connect()扫描技术只适用于找出 TCP 和 UDP 端口.

# nmap -sT 192.168.1.11
```

# Udp scan(sU)

```
顾名思义,这种扫描技术用来寻找目标主机打开的 UDP 端口.
它不需要发送任何的 SYN 包,因为这种技术是针对 UDP 端口的.
UDP 扫描发送 UDP 数据包到目标主机,并等待响应,如果返回 ICMP 不可达的错误消息,说明端口是关闭的,如果得到正确的适当的回应,说明端口是开放的.

# nmap -sU 192.168.1.11
```

# FIN scan (sF)

```
有时候 Tcp SYN 扫描不是最佳的扫描模式,因为有防火墙的存在.
目标主机有时候可能有 IDS 和 IPS 系统的存在,防火墙会阻止掉 SYN 数据包.
发送一个设置了 FIN 标志的数据包并不需要完成 TCP 的握手.

# nmap -sF 192.168.1.8

FIN 扫描也不会在目标主机上创建日志(FIN扫描的优势之一).
各类型的扫描都是具有差异性的, FIN 扫描发送的包只包含 FIN 标识, NULL 扫描不发送数据包上的任何字节, XMAS 扫描发送 FIN、PSH 和 URG 标识的数据包.
```

# PING Scan (sP)

```
PING 扫描不同于其它的扫描方式,因为它只用于找出主机是否是存在在网络中的.
它不是用来发现是否开放端口的. PING 扫描需要 root 权限,如果用户没有 root 权限, PING 扫描将会使用 connect() 调用.

# nmap -sP 192.168.1.18
```

# 版本检测(sV)

```
版本检测是用来扫描目标主机和端口上运行的软件的版本.
它不同于其它的扫描技术,它不是用来扫描目标主机上开放的端口,不过它需要从开放的端口获取信息来判断软件的版本.
使用版本检测扫描之前需要先用 TCP SYN 扫描开放了哪些端口.

# nmap -sV 192.168.1.11
```

# Idle scan (sL)

```
Idle scan 是一种先进的扫描技术,它不是用你真实的主机 IP 发送数据包,而是使用另外一个目标网络的主机发送数据包.

# nmap -sL 192.168.1.6 192.168.1.11

Idle scan 是一种理想的匿名扫描技术,通过目标网络中的`192.168.1.6`向主机`192.168.1.11`发送数据,来获取`192.168.1.11`开放的端口.
有需要其它的扫描技术,如 FTP bounce(FTP反弹), fragmentation scan(碎片扫描), IP protocol scan(IP协议扫描).
```

# Nmap的OS检测(O)

``
nmap 最重要的特点之一是能够远程检测操作系统和软件, nmap 的 OS 检测技术在渗透测试中用来了解远程主机的操作系统和软件是非常有用的,通过获取的信息你可以知道已知的漏洞.
nmap 有一个名为的 nmap-OS-DB 数据库,该数据库包含超过 2600 操作系统的信息.
nmap 把 TCP 和 UDP 数据包发送到目标机器上,然后检查结果和数据库对照.

# nmap -O 192.168.1.11

如果远程主机有防火墙, IDS 和 IPS 系统,可以使用 -PN 命令来确保不 ping 远程主机.因为有时候防火墙会阻止掉 ping 请求.
-PN命令告诉 nmap 不用 ping 远程主机.

# nmap -O -PN 192.168.1.1/24
以上命令告诉发信主机远程主机是存活在网络上的,所以没有必要发送 ping 请求,使用 -PN 参数可以绕过 ping 命令,但是不影响主机的系统的发现.

nmap 的操作系统检测的基础是有开放和关闭的端口,如果 OS scan 无法检测到至少一个开放或者关闭的端口,会返回以下错误:
`Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port`

OS Scan 的结果是不可靠的,因为没有发现至少一个开放或者关闭的端口.
如果 nmap 不能检测到远程操作系统类型,那么就没有必要使用 -osscan_limit 检测.

想好通过 nmap 准确的检测到远程操作系统是比较困难的,需要使用到 nmap 的猜测功能选项, –osscan-guess 猜测认为最接近目标的匹配操作系统类型.

# nmap -O –osscan-guess 192.168.1.11
```

